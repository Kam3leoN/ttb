(function(){"use strict";function L(d){return new Promise((t,e)=>{const s=new Audio(d);s.onended=()=>t(),s.onerror=()=>e(new Error(`Failed to play audio: ${d}`)),s.play().catch(e)})}function k(d,t){return t?L(d):null}class I{constructor(){this.state="muted",this.soundtrack=null,this.audioSrc="./audios/sounds/"}init(t){this.soundtrack=t,this.soundtrack&&(this.soundtrack.volume=.5,this.soundtrack.loop=!0),this.setMuted(!0)}setMuted(t){this.state=t?"muted":"unmuted",this.soundtrack&&(this.soundtrack.volume=t?0:.5),document.querySelectorAll("audio").forEach(e=>{e.volume=t?0:.5})}toggleMute(){this.setMuted(this.state==="unmuted")}getState(){return this.state}play(t){L(`${this.audioSrc}${t}`)}playIfNotMuted(t){k(`${this.audioSrc}${t}`,this.state==="unmuted")}playSoundtrack(){this.soundtrack&&this.state==="unmuted"&&this.soundtrack.play().catch(console.error)}pauseSoundtrack(){this.soundtrack&&(this.soundtrack.pause(),this.soundtrack.currentTime=0)}setAudioSrc(t){this.audioSrc=t}}const T=["JAN","FEV","MAR","AVR","MAI","JUN","JUL","AOU","SEP","OCT","NOV","DEC"];function D(d){const t=d.getDate(),e=T[d.getMonth()],s=d.getFullYear();let i=d.getHours();const n=d.getMinutes(),a=d.getSeconds(),h=i<12;return i=i%12,i=i||12,{month:e,day:w(t),year:s.toString(),hour:w(i),minute:w(n),second:w(a),isAM:h}}function w(d){return d<10?`0${d}`:`${d}`}function r(d){return document.getElementById(d)}function C(d){return document.querySelector(d)}function E(d){return document.querySelectorAll(d)}function y(d){const t=typeof d=="string"?parseInt(d,10):d;return t<10?`0${t}`:`${t}`}class A{constructor(){this.updateActive=!0,this.intervalId=null}start(){this.updateActive=!0,this.update()}stop(){this.updateActive=!1,this.intervalId!==null&&(clearTimeout(this.intervalId),this.intervalId=null)}update(){if(!this.updateActive){this.intervalId=window.setTimeout(()=>this.update(),1e3);return}const t=D(new Date);this.updatePresentTime(t),this.intervalId=window.setTimeout(()=>this.update(),1e3)}updatePresentTime(t){const e=r("present-month"),s=r("present-day"),i=r("present-year"),n=r("present-hour"),a=r("present-minute"),h=r("am-present"),c=r("pm-present");if(e){const o=e.querySelector(".month-text-main"),l=e.querySelector(".month-text-shadow");o&&(o.textContent=t.month),l&&(l.textContent=""),!o&&!l&&(e.textContent=t.month)}if(s){const o=s.querySelector(".day-text-main"),l=s.querySelector(".day-text-shadow");o&&(o.textContent=t.day),!o&&!l&&(s.textContent=t.day)}if(i){const o=i.querySelector(".year-text-main"),l=i.querySelector(".year-text-shadow");o&&(o.textContent=t.year),!o&&!l&&(i.textContent=t.year)}if(n){const o=n.querySelector(".hour-text-main"),l=n.querySelector(".hour-text-shadow");o&&(o.textContent=t.hour),!o&&!l&&(n.textContent=t.hour)}if(a){const o=a.querySelector(".minute-text-main"),l=a.querySelector(".minute-text-shadow");o&&(o.textContent=t.minute),!o&&!l&&(a.textContent=t.minute)}h&&c&&(t.isAM?(h.classList.add("light-on"),h.classList.remove("light-off"),c.classList.add("light-off"),c.classList.remove("light-on")):(h.classList.add("light-off"),h.classList.remove("light-on"),c.classList.add("light-on"),c.classList.remove("light-off")))}isUpdateActive(){return this.updateActive}setUpdateActive(t){this.updateActive=t}getCurrentDateTime(){return D(new Date)}getMonths(){return T}}class S{constructor(t){const e=this.parseDate(t.date||"01/01/1972"),s=this.parseHour(t.hour||"00:00:00");this.options={...t,month:t.month||e.month,day:t.day||e.day,year:t.year||e.year,hour:s.hour,minute:t.minute||s.minute,second:t.second||s.second,isAM:t.isAM??s.isAM,text:t.text||""},this.type=t.type,this.container=null}parseDate(t){if(t==="today"){const s=new Date;return{month:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][s.getMonth()],day:String(s.getDate()).padStart(2,"0"),year:String(s.getFullYear())}}const e=t.split("/");if(e.length===3){const s=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],i=parseInt(e[0],10)-1;return{month:s[i]||"JAN",day:e[1].padStart(2,"0"),year:e[2]}}return{month:"JAN",day:"01",year:"1972"}}parseHour(t){if(t==="today"){const s=new Date;let i=s.getHours();const n=i<12,a=i===0?12:i>12?i-12:i;return{hour:String(a).padStart(2,"0"),minute:String(s.getMinutes()).padStart(2,"0"),second:String(s.getSeconds()).padStart(2,"0"),isAM:n}}const e=t.split(":");if(e.length>=2){const s=parseInt(e[0],10),i=s<12,n=s===0?12:s>12?s-12:s;return{hour:String(n).padStart(2,"0"),minute:e[1].padStart(2,"0"),second:e[2]?e[2].padStart(2,"0"):"00",isAM:i}}return{hour:"00",minute:"00",second:"00",isAM:!0}}init(){this.options.container&&this.createHTML()}createHTML(){const t=typeof this.options.container=="string"?C(this.options.container):this.options.container;if(!t)throw new Error(`Container not found for TimeCircuit ${this.type}`);this.container=t;const e=this.type==="destination"?"destination":this.type==="present"?"present":"departed",s=document.createElement("div");s.className=`individual-time-circuit-wrapper-area ${e}`;const i=document.createElement("div");i.className="individual-time-circuit-content";const n=document.createElement("div");n.className="row-of-labels";const a=this.type==="destination"?"dest_label":this.type==="present"?"present_label":"last_label";n.innerHTML=`
      <div class="sticker-label month ${a}_month">MONTH</div>
      <div class="sticker-label day ${a}_day">DAY</div>
      <div class="sticker-label year ${a}_year">YEAR</div>
      <div class="sticker-label hour ${a}_hour">HOUR</div>
      <div class="sticker-label min ${a}_min">MIN</div>
    `;const h=document.createElement("div");h.className="row-of-numbers-display-area",h.innerHTML=`
      <div class="console-display lcd console-month" id="${this.type}-month">
        <span class="month-text month-text-main">${this.options.month||""}</span>
        <span class="month-text month-text-shadow"></span>
      </div>
      <div class="console-display lcd console-day" id="${this.type}-day">
        <span class="day-text day-text-main">${this.options.day||""}</span>
        <span class="day-text day-text-shadow">88</span>
      </div>
      <div class="console-display lcd console-year" id="${this.type}-year">
        <span class="year-text year-text-main">${this.options.year||""}</span>
        <span class="year-text year-text-shadow">8888</span>
      </div>
      <div class="console-display console-am-pm">
        <div class="am-label ${a}_am"></div>
        <div class="light am ${this.options.isAM?"light-on":"light-off"}" id="am-${this.type}"></div>
        <div class="pm-label ${a}_pm"></div>
        <div class="light pm ${this.options.isAM?"light-off":"light-on"}" id="pm-${this.type}"></div>
      </div>
      <div class="console-display lcd console-hour" id="${this.type}-hour">
        <span class="hour-text hour-text-main">${this.options.hour||""}</span>
        <span class="hour-text hour-text-shadow">88</span>
      </div>
      <div class="console-display colon">
        <div class="colon top"></div>
        <div class="colon bottom"></div>
      </div>
      <div class="console-display lcd console-minute" id="${this.type}-minute">
        <span class="minute-text minute-text-main">${this.options.minute||""}</span>
        <span class="minute-text minute-text-shadow">88</span>
      </div>
      <div class="console-display colon">
        <div class="colon top"></div>
        <div class="colon bottom"></div>
      </div>
      <div class="console-display lcd console-second" id="${this.type}-second">${this.options.second||"00"}</div>
    `;const c=document.createElement("div");c.className="footer-label",c.textContent=this.options.text||"",i.appendChild(n),i.appendChild(h),i.appendChild(c),s.appendChild(i),this.container.appendChild(s)}update(t){const e=r(`${this.type}-month`),s=r(`${this.type}-day`),i=r(`${this.type}-year`),n=r(`${this.type}-hour`),a=r(`${this.type}-minute`),h=r(`am-${this.type}`),c=r(`pm-${this.type}`);if(e){const o=e.querySelector(".month-text-main"),l=e.querySelector(".month-text-shadow");o&&(o.textContent=t.month),l&&(l.textContent=""),!o&&!l&&(e.textContent=t.month)}if(s){const o=s.querySelector(".day-text-main"),l=s.querySelector(".day-text-shadow");o&&(o.textContent=t.day),!o&&!l&&(s.textContent=t.day)}if(i){const o=i.querySelector(".year-text-main"),l=i.querySelector(".year-text-shadow");o&&(o.textContent=t.year),!o&&!l&&(i.textContent=t.year)}if(n){const o=n.querySelector(".hour-text-main"),l=n.querySelector(".hour-text-shadow");o&&(o.textContent=t.hour),!o&&!l&&(n.textContent=t.hour)}if(a){const o=a.querySelector(".minute-text-main"),l=a.querySelector(".minute-text-shadow");o&&(o.textContent=t.minute),!o&&!l&&(a.textContent=t.minute)}h&&c&&(t.isAM?(h.classList.add("light-on"),h.classList.remove("light-off"),c.classList.add("light-off"),c.classList.remove("light-on")):(h.classList.add("light-off"),h.classList.remove("light-on"),c.classList.add("light-on"),c.classList.remove("light-off")))}getDateTime(){const t=r(`${this.type}-month`),e=r(`${this.type}-day`),s=r(`${this.type}-year`),i=r(`${this.type}-hour`),n=r(`${this.type}-minute`),a=r(`am-${this.type}`),h=c=>{if(!c)return"";const o=c.querySelector(".month-text-main, .day-text-main, .year-text-main, .hour-text-main, .minute-text-main");return(o==null?void 0:o.textContent)||""};return{month:h(t),day:h(e),year:h(s),hour:h(i),minute:h(n),isAM:(a==null?void 0:a.classList.contains("light-on"))||!1}}getType(){return this.type}}class q{constructor(t){this.animation=null,this.min=t.min,this.max=t.max,this.current=t.current,this.element=t.element,this.modalElement=r("speedometer-modal"),this.modalDisplayElement=r("speedometer-modal-value")}init(){this.updateDisplay(),this.modalElement&&this.modalElement.addEventListener("click",t=>{t.target===this.modalElement&&this.closeModal()}),document.addEventListener("keydown",t=>{var e;t.key==="Escape"&&((e=this.modalElement)!=null&&e.classList.contains("active"))&&this.closeModal()})}updateDisplay(){if(this.element){const t=this.element.querySelector(".speedometer-text-main"),e=this.element.querySelector(".speedometer-text-shadow");t&&(t.textContent=y(this.current)),!t&&!e&&(this.element.textContent=y(this.current))}if(this.modalDisplayElement){const t=this.modalDisplayElement.querySelector(".speedometer-text-main"),e=this.modalDisplayElement.querySelector(".speedometer-text-shadow");t&&(t.textContent=y(this.current)),!t&&!e&&(this.modalDisplayElement.textContent=y(this.current))}}openModal(){this.modalElement&&this.modalElement.classList.add("active")}closeModal(){this.modalElement&&this.modalElement.classList.remove("active")}setSpeed(t){this.current=Math.max(this.min,Math.min(this.max,t)),this.updateDisplay()}getSpeed(){return this.current}reset(){this.cancelAnimation(),this.current=this.min,this.updateDisplay()}cancelAnimation(){this.animation&&(this.animation.cancel(),this.animation=null)}animate(t){this.cancelAnimation(),this.current=this.min;let e=!1;const s=1e3,i=Date.now(),n=()=>{if(e)return;const h=Date.now()-i,c=Math.min(h/s,1),o=1-Math.pow(1-c,3);this.current=Math.floor(0+80*o),this.updateDisplay(),c<1?requestAnimationFrame(n):(this.current=80,a())},a=()=>{if(e)return;let h=80;const c=150;let o=0;const l=()=>{e||(h=80+o,this.current=h,this.updateDisplay(),o++,h<88?setTimeout(l,c):(this.animation=null,setTimeout(()=>{this.closeModal(),t&&t()},1e3)))};l()};this.animation={cancel:()=>{e=!0}},n()}}class ${constructor(t){this.input="",this.modal=r("keypad-modal"),this.displayDate=r("keypad-display-date"),this.displayTime=r("keypad-display-time"),this.mode="destination",this.audioManager=t}init(){const t=C(".date"),e=E(".mode-btn"),s=E(".keypad-key");t&&t.addEventListener("click",()=>this.open()),this.modal&&this.modal.addEventListener("click",i=>{i.target===this.modal&&this.close()}),e.forEach(i=>{i.addEventListener("click",()=>{const n=i.getAttribute("data-mode");this.setMode(n)})}),s.forEach(i=>{i.addEventListener("click",()=>{const n=i.getAttribute("data-key");n&&this.handleKey(n)})}),document.addEventListener("keydown",i=>{if(!this.modal||!this.modal.classList.contains("active"))return;let n=null;if(i.key>="0"&&i.key<="9")n=i.key;else if(i.key==="Enter"||i.key==="Return")n="enter";else if(i.key==="Escape"||i.key==="Esc"){this.close();return}else(i.key==="Backspace"||i.key==="Delete")&&(n="backspace");n!==null&&(i.preventDefault(),this.animateKey(n),this.handleKey(n))})}open(){this.modal&&(this.modal.classList.add("active"),this.mode="destination",this.input="",this.updateDisplay(),this.updateModeButtons())}close(){this.modal&&(this.modal.classList.remove("active"),this.input="",this.updateDisplay())}setMode(t){this.mode=t,this.input="",this.updateDisplay(),this.updateModeButtons()}updateModeButtons(){E(".mode-btn").forEach(e=>{if(e.disabled){e.classList.remove("active");return}e.getAttribute("data-mode")===this.mode?e.classList.add("active"):e.classList.remove("active")})}animateKey(t){const e=C(`.keypad-key[data-key="${t}"]`);e&&(e.classList.add("active"),setTimeout(()=>{e.classList.remove("active")},150))}getDialAudio(t){const e=parseInt(t,10);return e===1||e===4||e===7?"bttf-dial-1.mp3":e===2||e===5||e===8||e===0?"bttf-dial-2.mp3":"bttf-dial-3.mp3"}handleKey(t){t==="clear"?(this.input="",this.updateDisplay(),this.audioManager.play("bttf-input-button.mp3")):t==="backspace"?this.input.length>0?(this.input=this.input.substring(0,this.input.length-1),this.updateDisplay(),this.audioManager.playIfNotMuted("bttf-dial-1.mp3")):this.audioManager.play("bttf-input-error.mp3"):t==="enter"?(this.processInput(),this.audioManager.play("bttf-input-button.mp3")):this.input.length<12?(this.input+=t,this.updateDisplay(),this.audioManager.playIfNotMuted(this.getDialAudio(t))):this.audioManager.play("bttf-input-error.mp3")}updateDisplay(){if(!this.displayDate||!this.displayTime)return;if(this.input.length===0){this.displayDate.textContent="MM/DD/YYYY",this.displayTime.textContent="HH:MM";return}const t="MM/DD/YYYY",e="HH:MM",s=t.split(""),i=e.split("");let n=0;for(let a=0;a<s.length&&n<this.input.length&&n<8;a++)s[a]!=="/"&&(s[a]=this.input[n],n++);for(let a=0;a<i.length&&n<this.input.length;a++)i[a]!==":"&&(i[a]=this.input[n],n++);this.displayDate.textContent=s.join(""),this.displayTime.textContent=i.join("")}processInput(){if(this.input.length===0){this.audioManager.play("bttf-input-error.mp3");return}const t=this.input.split("").map(Number),e=r("error");e&&(e.style.display="none"),this.mode==="destination"?this.processDestinationTime(t):this.mode==="present"?this.processPresentTime(t):this.mode==="departed"&&this.processDepartedTime(t),this.input="",this.updateDisplay(),this.close()}processDestinationTime(t){const e=r("error");if(t.length%2||t.length===6){e&&(e.textContent="* INVALID * INPUT",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}if(t.length>=2){const s=t[0]*10+t[1];if(s===0||s>12){e&&(e.textContent="* INVALID * MONTH",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const i=r("destination-month");if(i){const n=i.querySelector(".month-text-main"),a=i.querySelector(".month-text-shadow"),h=T[s-1];n&&(n.textContent=h),a&&(a.textContent=h),!n&&!a&&(i.textContent=h)}}if(t.length>=4){const s=t[2]*10+t[3];if(s===0||s>31){e&&(e.textContent="* INVALID * DAY",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const i=r("destination-day");if(i){const n=i.querySelector(".day-text-main"),a=i.querySelector(".day-text-shadow");n&&(n.textContent=y(s)),!n&&!a&&(i.textContent=y(s))}}if(t.length>=8){const s=t[4]*1e3+t[5]*100+t[6]*10+t[7],i=r("destination-year");if(i){const n=i.querySelector(".year-text-main"),a=i.querySelector(".year-text-shadow");n&&(n.textContent=s.toString()),!n&&!a&&(i.textContent=s.toString())}}if(t.length>=10){const s=t[8]*10+t[9];if(s>23){e&&(e.textContent="* INVALID * HOUR",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}let i=s;const n=r("am-destination"),a=r("pm-destination");s>12?(i=s-12,i<10&&(i=parseInt(`0${i}`)),n&&a&&(n.classList.add("light-off"),n.classList.remove("light-on"),a.classList.add("light-on"),a.classList.remove("light-off"))):(i<10&&(i=parseInt(`0${i}`)),n&&a&&(n.classList.add("light-on"),n.classList.remove("light-off"),a.classList.add("light-off"),a.classList.remove("light-on"))),s===12&&n&&a&&(n.classList.remove("light-on"),n.classList.add("light-off"),a.classList.add("light-on"),a.classList.remove("light-off"));const h=r("destination-hour");if(h){const c=h.querySelector(".hour-text-main"),o=h.querySelector(".hour-text-shadow");c&&(c.textContent=y(i)),!c&&!o&&(h.textContent=y(i))}}if(t.length>=12){const s=t[10]*10+t[11];if(s>59){e&&(e.textContent="* INVALID * MINUTE",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const i=r("destination-minute");if(i){const n=i.querySelector(".minute-text-main"),a=i.querySelector(".minute-text-shadow");n&&(n.textContent=y(s)),!n&&!a&&(i.textContent=y(s))}}this.audioManager.play("bttf-input-success.mp3")}processPresentTime(t){const e=r("error");if(t.length<12){e&&(e.textContent="* INCOMPLETE * INPUT",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const s=t[0]*10+t[1],i=t[2]*10+t[3],n=t[4]*1e3+t[5]*100+t[6]*10+t[7],a=t[8]*10+t[9],h=t[10]*10+t[11];if(s===0||s>12||i===0||i>31||a>23||h>59){e&&(e.textContent="* INVALID * INPUT",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const c=r("present-month"),o=r("present-day"),l=r("present-year"),m=r("present-hour"),p=r("present-minute"),f=r("am-present"),g=r("pm-present");if(c){const u=c.querySelector(".month-text-main"),x=c.querySelector(".month-text-shadow"),M=T[s-1];u&&(u.textContent=M),x&&(x.textContent=""),!u&&!x&&(c.textContent=M)}if(o){const u=o.querySelector(".day-text-main"),x=o.querySelector(".day-text-shadow");u&&(u.textContent=y(i)),!u&&!x&&(o.textContent=y(i))}if(l){const u=l.querySelector(".year-text-main"),x=l.querySelector(".year-text-shadow");u&&(u.textContent=n.toString()),!u&&!x&&(l.textContent=n.toString())}let v=a;if(a>12?(v=a-12,v<10&&(v=parseInt(`0${v}`)),f&&g&&(f.classList.add("light-off"),f.classList.remove("light-on"),g.classList.add("light-on"),g.classList.remove("light-off"))):(v<10&&(v=parseInt(`0${v}`)),f&&g&&(f.classList.add("light-on"),f.classList.remove("light-off"),g.classList.add("light-off"),g.classList.remove("light-on"))),a===12&&f&&g&&(f.classList.remove("light-on"),f.classList.add("light-off"),g.classList.add("light-on"),g.classList.remove("light-off")),m){const u=m.querySelector(".hour-text-main"),x=m.querySelector(".hour-text-shadow");u&&(u.textContent=y(v)),!u&&!x&&(m.textContent=y(v))}if(p){const u=p.querySelector(".minute-text-main"),x=p.querySelector(".minute-text-shadow");u&&(u.textContent=y(h)),!u&&!x&&(p.textContent=y(h))}this.audioManager.play("bttf-input-success.mp3")}processDepartedTime(t){const e=r("error");if(t.length<12){e&&(e.textContent="* INCOMPLETE * INPUT",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const s=t[0]*10+t[1],i=t[2]*10+t[3],n=t[4]*1e3+t[5]*100+t[6]*10+t[7],a=t[8]*10+t[9],h=t[10]*10+t[11];if(s===0||s>12||i===0||i>31||a>23||h>59){e&&(e.textContent="* INVALID * INPUT",e.style.display="block"),this.audioManager.play("bttf-input-error.mp3");return}const c=r("departed-month"),o=r("departed-day"),l=r("departed-year"),m=r("departed-hour"),p=r("departed-minute"),f=r("am-departed"),g=r("pm-departed");if(c){const u=c.querySelector(".month-text-main"),x=c.querySelector(".month-text-shadow"),M=T[s-1];u&&(u.textContent=M),x&&(x.textContent=""),!u&&!x&&(c.textContent=M)}if(o){const u=o.querySelector(".day-text-main"),x=o.querySelector(".day-text-shadow");u&&(u.textContent=y(i)),!u&&!x&&(o.textContent=y(i))}if(l){const u=l.querySelector(".year-text-main"),x=l.querySelector(".year-text-shadow");u&&(u.textContent=n.toString()),!u&&!x&&(l.textContent=n.toString())}let v=a;if(a>12?(v=a-12,v<10&&(v=parseInt(`0${v}`)),f&&g&&(f.classList.add("light-off"),f.classList.remove("light-on"),g.classList.add("light-on"),g.classList.remove("light-off"))):(v<10&&(v=parseInt(`0${v}`)),f&&g&&(f.classList.add("light-on"),f.classList.remove("light-off"),g.classList.add("light-off"),g.classList.remove("light-on"))),a===12&&f&&g&&(f.classList.remove("light-on"),f.classList.add("light-off"),g.classList.add("light-on"),g.classList.remove("light-off")),m){const u=m.querySelector(".hour-text-main"),x=m.querySelector(".hour-text-shadow");u&&(u.textContent=y(v)),!u&&!x&&(m.textContent=y(v))}if(p){const u=p.querySelector(".minute-text-main"),x=p.querySelector(".minute-text-shadow");u&&(u.textContent=y(h)),!u&&!x&&(p.textContent=y(h))}this.audioManager.play("bttf-input-success.mp3")}}class N{constructor(t){this.state="off",this.button=C(".start"),this.icon=r("start-icon"),this.audioManager=t}init(){this.button&&this.button.addEventListener("click",()=>this.toggle()),this.updateIcon()}toggle(){this.state==="off"?this.turnOn():this.turnOff()}turnOn(){this.audioManager.play("bttf-time-circuits-on.mp3"),this.state="on",this.updateIcon()}turnOff(){this.audioManager.play("bttf-time-circuits-off.mp3"),this.state="off",this.updateIcon(),this.audioManager.pauseSoundtrack()}updateIcon(){this.icon&&(this.icon.style.opacity=this.state==="on"?"1":"0.7")}getState(){return this.state}}class B{constructor(t,e,s,i,n,a,h){this.resetCount=0,this.button=C(".reset"),this.audioManager=t,this.timeManager=e,this.speedometer=s,this.powerButton=i,this.destinationCircuit=n,this.presentCircuit=a,this.departedCircuit=h}init(){this.button&&this.button.addEventListener("click",()=>this.handleReset())}handleReset(){this.speedometer.reset(),this.resetDates(),this.powerButton.getState()==="on"?(this.audioManager.play("power-up.mp3"),this.powerButton.toggle(),this.audioManager.pauseSoundtrack(),setTimeout(()=>{this.powerButton.toggle(),this.audioManager.playSoundtrack(),setTimeout(()=>{this.speedometer.animate()},500)},3e3)):setTimeout(()=>{this.speedometer.animate()},500)}resetDates(){if(this.resetCount++,this.resetCount===1){const e=this.presentCircuit.getDateTime();this.departedCircuit.update(e);const s=this.timeManager.getCurrentDateTime();this.presentCircuit.update({month:s.month,day:s.day,year:s.year,hour:s.hour,minute:s.minute,isAM:s.isAM})}else{this.resetCount=0,this.departedCircuit.update({month:"OCT",day:"26",year:"1985",hour:"01",minute:"21",isAM:!0});const e=this.timeManager.getCurrentDateTime();this.presentCircuit.update({month:e.month,day:e.day,year:e.year,hour:e.hour,minute:e.minute,isAM:e.isAM}),this.destinationCircuit.update({month:"NOV",day:"12",year:"1955",hour:"06",minute:"39",isAM:!0})}const t=r("error");t&&(t.style.display="none"),this.timeManager.setUpdateActive(!0)}}class O{constructor(t){this.button=r("mute-btn"),this.icon=r("mute-icon"),this.audioManager=t}init(){this.button&&this.button.addEventListener("click",()=>this.toggle()),this.updateIcon()}toggle(){this.audioManager.toggleMute(),this.updateIcon()}updateIcon(){this.icon&&(this.audioManager.getState()==="muted"?this.icon.src="assets/icons/volume-mute.svg":this.icon.src="assets/icons/volume.svg")}}class P{constructor(){this.currentTheme="dark",this.button=r("theme-btn"),this.icon=r("theme-icon"),this.loadTheme()}init(){this.button&&this.button.addEventListener("click",()=>this.toggle()),this.updateTheme()}loadTheme(){const t=localStorage.getItem("theme");t?this.currentTheme=t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?this.currentTheme="light":this.currentTheme="dark"}toggle(){this.currentTheme=this.currentTheme==="dark"?"light":"dark",this.updateTheme(),localStorage.setItem("theme",this.currentTheme)}updateTheme(){const t=document.documentElement;t.classList.remove("dark","light"),t.classList.add(this.currentTheme),this.updateIcon()}updateIcon(){this.icon&&(this.currentTheme==="dark"?(this.icon.src="assets/icons/sun.svg",this.icon.alt="Switch to light theme"):(this.icon.src="assets/icons/moon.svg",this.icon.alt="Switch to dark theme"))}getTheme(){return this.currentTheme}}class H{constructor(){this.overlayElement=r("travel-overlay"),this.svgElement=r("travel-overlay-svg")}init(){this.overlayElement&&this.overlayElement.classList.remove("active")}show(){this.overlayElement&&this.overlayElement.classList.add("active")}hide(){this.overlayElement&&this.overlayElement.classList.remove("active")}isVisible(){var t;return((t=this.overlayElement)==null?void 0:t.classList.contains("active"))||!1}}class U{constructor(t,e,s,i,n,a,h,c){this.desTime=[],this.audioManager=t,this.timeManager=e,this.speedometer=s,this.powerButton=i,this.destinationCircuit=n,this.presentCircuit=a,this.departedCircuit=h,this.travelOverlay=c}init(){window.addEventListener("keydown",t=>this.handleKeyDown(t))}handleKeyDown(t){const e=t.key;if(e>="0"&&e<="9"){this.setDesTime(e),this.audioManager.playIfNotMuted(`bttf-dial-${e==="1"||e==="4"||e==="7"?"1":e==="2"||e==="5"||e==="8"||e==="0"?"2":"3"}.mp3`);return}switch(e){case"Enter":this.inpDesTime(),this.audioManager.play("bttf-input-button.mp3");break;case"x":case"X":this.travelInTime();break;case"Escape":this.audioManager.play("bttf-input-button.mp3");break}}setDesTime(t){if(this.powerButton.getState()==="off")return;this.desTime.length<12?this.desTime.push(t):this.audioManager.play("bttf-input-error.mp3");const e=r("error");e&&(e.style.display="none")}isDestinationTimeComplete(){const t=this.destinationCircuit.getDateTime();return t.month!==""&&t.day!==""&&t.year!==""&&t.hour!==""&&t.minute!==""}inpDesTime(){if(this.powerButton.getState()==="off")return;const t=this.desTime,e=r("error");let s=!1;const i=()=>{if(t[0]==="0"&&t[1]==="0"||parseInt(t[0]+t[1])>12)e&&(e.textContent="* INVALID * MONTH",e.style.display="block"),s=!0;else{const o=parseInt(t[0]+t[1])-1,l=r("destination-month");if(l){const m=l.querySelector(".month-text-main"),p=l.querySelector(".month-text-shadow"),f=T[o];m&&(m.textContent=f),p&&(p.textContent=""),!m&&!p&&(l.textContent=f)}}},n=()=>{if(t[2]==="0"&&t[3]==="0"||parseInt(t[2]+t[3])>31)e&&(e.textContent="* INVALID * DAY",e.style.display="block"),s=!0;else{const o=t[2]+t[3],l=r("destination-day");if(l){const m=l.querySelector(".day-text-main"),p=l.querySelector(".day-text-shadow");m&&(m.textContent=o),!m&&!p&&(l.textContent=o)}}},a=()=>{const o=t[4]+t[5]+t[6]+t[7],l=r("destination-year");if(l){const m=l.querySelector(".year-text-main"),p=l.querySelector(".year-text-shadow");m&&(m.textContent=o),!m&&!p&&(l.textContent=o)}},h=()=>{const o=parseInt(t[8]+t[9]);if(o>23)e&&(e.textContent="* INVALID * HOUR",e.style.display="block"),s=!0;else{let l=o;const m=r("am-destination"),p=r("pm-destination");o>12?(l=o-12,l<10&&(l=parseInt(`0${l}`)),m&&p&&(m.classList.add("light-off"),m.classList.remove("light-on"),p.classList.add("light-on"),p.classList.remove("light-off"))):(l<10&&(l=parseInt(`0${l}`)),m&&p&&(m.classList.add("light-on"),m.classList.remove("light-off"),p.classList.add("light-off"),p.classList.remove("light-on"))),o===12&&m&&p&&(m.classList.remove("light-on"),m.classList.add("light-off"),p.classList.add("light-on"),p.classList.remove("light-off"));const f=r("destination-hour");if(f){const g=f.querySelector(".hour-text-main"),v=f.querySelector(".hour-text-shadow");g&&(g.textContent=y(l)),!g&&!v&&(f.textContent=y(l))}}},c=()=>{const o=parseInt(t[10]+t[11]);if(o>59)e&&(e.textContent="* INVALID * MINUTE",e.style.display="block"),s=!0;else{const l=r("destination-minute");if(l){const m=l.querySelector(".minute-text-main"),p=l.querySelector(".minute-text-shadow");m&&(m.textContent=y(o)),!m&&!p&&(l.textContent=y(o))}}};t.length%2||t.length===6?(e&&(e.textContent="* INVALID * INPUT",e.style.display="block"),s=!0):t.length===2?i():t.length===4?(i(),n()):t.length===8?(i(),n(),a()):t.length===10?(i(),n(),a(),h()):t.length===12&&(i(),n(),a(),h(),c()),this.desTime.length===0||s?this.audioManager.play("bttf-input-error.mp3"):(this.audioManager.play("bttf-input-success.mp3"),t.length===12&&!s&&setTimeout(()=>{if(this.isDestinationTimeComplete()){const o=this.presentCircuit.getDateTime();this.departedCircuit.update(o),this.timeManager.setUpdateActive(!1),this.travelOverlay.show(),this.speedometer.openModal(),this.audioManager.playSoundtrack(),this.speedometer.animate(()=>{const l=this.destinationCircuit.getDateTime();this.presentCircuit.update(l),this.travelOverlay.hide()})}},100)),this.desTime=[],this.audioManager.play("bttf-input-button.mp3")}travelInTime(){if(this.powerButton.getState()==="off"){this.audioManager.play("bttf-input-error.mp3");return}if(!this.isDestinationTimeComplete()){this.audioManager.play("bttf-input-error.mp3");return}const t=this.presentCircuit.getDateTime();this.departedCircuit.update(t),this.timeManager.setUpdateActive(!1),this.travelOverlay.show(),this.speedometer.openModal(),this.audioManager.playSoundtrack(),this.speedometer.animate(()=>{const e=this.destinationCircuit.getDateTime();this.presentCircuit.update(e),this.travelOverlay.hide()}),this.audioManager.play("bttf-input-success.mp3")}}class b{init(){this.audioManager=new I,this.timeManager=new A;const t=r("soundtrack");this.audioManager.init(t);const e=r("speedometer-modal-value");if(e)this.speedometer=new q({min:0,max:88,current:0,element:e}),this.speedometer.init();else throw new Error("Speedometer element not found");this.destinationCircuit=new S({type:"destination",date:"11/12/1955",hour:"06:39:00",text:"DESTINATION TIME"}),this.presentCircuit=new S({type:"present",date:"today",hour:"today",text:"PRESENT TIME"}),this.departedCircuit=new S({type:"departed",date:"10/26/1985",hour:"01:21:00",text:"LAST TIME DEPARTED"}),this.destinationCircuit.init(),this.presentCircuit.init(),this.departedCircuit.init(),this.powerButton=new N(this.audioManager),this.powerButton.init(),this.muteButton=new O(this.audioManager),this.muteButton.init(),this.themeButton=new P,this.themeButton.init(),this.travelOverlay=new H,this.travelOverlay.init(),this.keypad=new $(this.audioManager),this.keypad.init(),this.resetButton=new B(this.audioManager,this.timeManager,this.speedometer,this.powerButton,this.destinationCircuit,this.presentCircuit,this.departedCircuit),this.resetButton.init(),this.keyboardController=new U(this.audioManager,this.timeManager,this.speedometer,this.powerButton,this.destinationCircuit,this.presentCircuit,this.departedCircuit,this.travelOverlay),this.keyboardController.init(),this.timeManager.start()}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new b().init()}):new b().init()})();
